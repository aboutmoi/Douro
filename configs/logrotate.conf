# Configuration logrotate pour Douro
# À placer dans /etc/logrotate.d/douro

/var/log/douro/*.log {
    # Rotation quotidienne
    daily
    
    # Garder 30 jours de logs
    rotate 30
    
    # Compresser les anciens logs
    compress
    delaycompress
    
    # Ne pas échouer si le fichier de log n'existe pas
    missingok
    
    # Ne pas faire de rotation si le fichier est vide
    notifempty
    
    # Créer le fichier de log avec les bonnes permissions
    create 644 douro douro
    
    # Utiliser copytruncate pour éviter de redémarrer le service
    copytruncate
    
    # Exécuter des commandes après la rotation
    postrotate
        # Optionnel: recharger le service pour rouvrir les fichiers de log
        # systemctl reload douro >/dev/null 2>&1 || true
    endscript
} 